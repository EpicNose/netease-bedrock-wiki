---
front:
hard: 入门
time: 10分钟
selection: true
---

# 性能监测与调试
随着模组内容的不断扩充和发展，开发者们制作的模组体量和复杂度越来越高，所需要的计算机资源越来越大，因此可能导致同一个模组在高性能设备和低性能设备的表现差异较大，开发者也会经常收到来自玩家的反馈，模组卡顿，游戏闪退等情况，为了尽可能保证大部分玩家的正常游戏体验，维护开发者的口碑，我们强烈建议开发者在模组制作后期，使用编辑器的性能工具对模组进行监测和调试，评估模组的性能表现，并寻找可以优化的性能问题。


## 1.性能监测工具
> 该工具仅支持在2.7稳定版及以上的ModPC开发包使用，不支持低版本或者上线测试的正式客户端。

性能监测工具是用于开发者监测ModPC开发包运行游戏时的帧率、内存、CPU占用率等常规性能数据的一款工具，开发者可以在启动开发包并加载模组后打开此工具，选择对应的游戏进程进行监测，通过监测工具的数据曲线变化，我们可以了解到这个模组运行过程中，对GPU、CPU和内存的占用情况，从而判断玩家在体验模组过程中的游戏体验是否流畅。
例如：原生游戏的帧率（FPS）一般在60帧左右，如果开发者加载模组后，发现帧率曲线存在强烈的波动，且均值在20帧左右，那么这个模组会严重破坏玩家的游戏体验，甚至导致游戏崩溃，强烈建议开发者对此模组进行优化。
### 使用方式
1. 通过编辑器→运行，开发测试，直接启动ModPC开发包等方式加载对应的存档或模组
2. 在启动器的工具箱中打开性能监测工具，如图
![图片](./images/performanceentrance1.png)


>也可以直接在ModPC开发包的快捷菜单中打开
![图片](./images/performanceentrance.png)

3. 选择第1步中启动的游戏进程，一般来说，单人测试只需启动一个ModPC开发包，也只有一个游戏进程。

![图片](./images/performance_open.png)

4. 在ModPC开发包进行正常游戏操作，并同时观察监测工具中的数值与曲线变化。

![图片](./images/performancetool.png)

5. 当停止监测时，会自动将当前的监测数据保存为图片，点击下方历史记录即可查看。

![图片](./images/performancehis.png)

## 2.脚本性能监测工具

脚本性能监测工具用于监测模组/存档中，脚本代码内不同函数的调用耗时火焰图。
### 使用方式
1. 与性能监测工具类似，先使用ModPC开发包加载某个存档，并在工具箱或快捷菜单中打开此工具。

2. 选择游戏进程后，配置监测时间，并开启监测，如图：

![图片](./images/scripttool.png)

3. 耐心等待监测结束，点击【查看火焰图】。

![图片](./images/scripttoolresult.png)

4. 根据火焰图结果定位调用频率过高或耗时过长的函数，进行对应的代码优化

![图片](./images/profile.png)

## 3.内存分析工具

内存分析工具与脚本性能监测工具类似，主要用于监测模组/存档中，不同脚本对游戏内存的占用火焰图。
### 使用方式
1. 使用ModPC开发包加载某个存档，并在工具箱或快捷菜单中打开此工具。

2. 选择游戏进程后，配置监测时间，并开启监测，如图：

![图片](./images/ramtool.png)

3. 耐心等待监测结束，点击【查看火焰图】。

![图片](./images/ramtoolresult.png)

4. 根据火焰图结果定位调用频率过高或内存占用过大的脚本，进行对应的代码优化。

![图片](./images/ramprofile.png)